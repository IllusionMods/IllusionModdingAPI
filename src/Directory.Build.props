<Project>
	<Target Name="PostBuild" AfterTargets="PostBuildEvent" Condition="'$(MSBuildProjectName.EndsWith(`API`))' == 'True'">
		<Copy DestinationFiles="$(TargetDir)\$(MSBuildProjectName).NativeHelper.dll" SourceFiles="..\Helper\bin\NativeHelper.dll" />
	</Target>
	
	<!-- Allow using of the csproj properties defined above in the code itself -->
	<Target Name="AddGeneratedConstantsFile" BeforeTargets="BeforeCompile;CoreCompile" Inputs="$(MSBuildAllProjects)" Outputs="$(IntermediateOutputPath)GeneratedConstantsFile.cs">
		<PropertyGroup>
			<GeneratedText>
				<![CDATA[namespace $(RootNamespace) {
    internal static class Constants2 {
        public const string NativeHelperFilename = "$(MSBuildProjectName).NativeHelper.dll"%3B
    }
}]]>
			</GeneratedText>
			<GeneratedFilePath>$(IntermediateOutputPath)GeneratedConstantsFile.cs</GeneratedFilePath>
		</PropertyGroup>
		<ItemGroup>
			<Compile Include="$(GeneratedFilePath)" />
			<FileWrites Include="$(GeneratedFilePath)" />
		</ItemGroup>
		<WriteLinesToFile Lines="$(GeneratedText)" File="$(GeneratedFilePath)" WriteOnlyWhenDifferent="true" Overwrite="true" />
	</Target>
</Project>